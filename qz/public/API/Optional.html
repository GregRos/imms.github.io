<!DOCTYPE html>
<html><head><title>Optional</title><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta property="og:title" content="Optional"/><meta property="og:description" content="The Optional&amp;lt;T&amp;gt; type is a really useful feature that indicates an optional value of type T. Why do you need it? § In particular, why not just use null and nullable types? Uniformity/Abstraction § The ."/><meta property="og:image" content="https://quartz.jzhao.xyz/static/og-image.png"/><meta property="og:width" content="1200"/><meta property="og:height" content="675"/><link rel="icon" href="../static/icon.png"/><meta name="description" content="The Optional&amp;lt;T&amp;gt; type is a really useful feature that indicates an optional value of type T. Why do you need it? § In particular, why not just use null and nullable types? Uniformity/Abstraction § The ."/><meta name="generator" content="Quartz"/><link rel="preconnect" href="https://fonts.googleapis.com"/><link rel="preconnect" href="https://fonts.gstatic.com"/><link href="../index.css" rel="stylesheet" type="text/css" spa-preserve/><link href="https://cdn.jsdelivr.net/npm/katex@0.16.0/dist/katex.min.css" rel="stylesheet" type="text/css" spa-preserve/><link href="https://fonts.googleapis.com/css2?family=IBM Plex Mono&amp;family=Schibsted Grotesk:wght@400;700&amp;family=Source Sans Pro:ital,wght@0,400;0,600;1,400;1,600&amp;display=swap" rel="stylesheet" type="text/css" spa-preserve/><script src="../prescript.js" type="application/javascript" spa-preserve></script><script type="application/javascript" spa-preserve>const fetchData = fetch("../static/contentIndex.json").then(data => data.json())</script></head><body data-slug="API/Optional"><div id="quartz-root" class="page"><div id="quartz-body"><div class="left sidebar"><h1 class="page-title "><a href="..">Imms</a></h1><div class="spacer mobile-only"></div><div class="search "><div id="search-icon"><p>Search</p><div></div><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search</title><desc id="desc">Search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"></path><circle cx="8" cy="8" r="7"></circle></g></svg></div><div id="search-container"><div id="search-space"><input autocomplete="off" id="search-bar" name="search" type="text" aria-label="Search for something" placeholder="Search for something"/><div id="results-container"></div></div></div></div><div class="darkmode "><input class="toggle" id="darkmode-toggle" type="checkbox" tabindex="-1"/><label id="toggle-label-light" for="darkmode-toggle" tabindex="-1"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="dayIcon" x="0px" y="0px" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35" xml:space="preserve"><title>Light mode</title><path d="M6,17.5C6,16.672,5.328,16,4.5,16h-3C0.672,16,0,16.672,0,17.5    S0.672,19,1.5,19h3C5.328,19,6,18.328,6,17.5z M7.5,26c-0.414,0-0.789,0.168-1.061,0.439l-2,2C4.168,28.711,4,29.086,4,29.5    C4,30.328,4.671,31,5.5,31c0.414,0,0.789-0.168,1.06-0.44l2-2C8.832,28.289,9,27.914,9,27.5C9,26.672,8.329,26,7.5,26z M17.5,6    C18.329,6,19,5.328,19,4.5v-3C19,0.672,18.329,0,17.5,0S16,0.672,16,1.5v3C16,5.328,16.671,6,17.5,6z M27.5,9    c0.414,0,0.789-0.168,1.06-0.439l2-2C30.832,6.289,31,5.914,31,5.5C31,4.672,30.329,4,29.5,4c-0.414,0-0.789,0.168-1.061,0.44    l-2,2C26.168,6.711,26,7.086,26,7.5C26,8.328,26.671,9,27.5,9z M6.439,8.561C6.711,8.832,7.086,9,7.5,9C8.328,9,9,8.328,9,7.5    c0-0.414-0.168-0.789-0.439-1.061l-2-2C6.289,4.168,5.914,4,5.5,4C4.672,4,4,4.672,4,5.5c0,0.414,0.168,0.789,0.439,1.06    L6.439,8.561z M33.5,16h-3c-0.828,0-1.5,0.672-1.5,1.5s0.672,1.5,1.5,1.5h3c0.828,0,1.5-0.672,1.5-1.5S34.328,16,33.5,16z     M28.561,26.439C28.289,26.168,27.914,26,27.5,26c-0.828,0-1.5,0.672-1.5,1.5c0,0.414,0.168,0.789,0.439,1.06l2,2    C28.711,30.832,29.086,31,29.5,31c0.828,0,1.5-0.672,1.5-1.5c0-0.414-0.168-0.789-0.439-1.061L28.561,26.439z M17.5,29    c-0.829,0-1.5,0.672-1.5,1.5v3c0,0.828,0.671,1.5,1.5,1.5s1.5-0.672,1.5-1.5v-3C19,29.672,18.329,29,17.5,29z M17.5,7    C11.71,7,7,11.71,7,17.5S11.71,28,17.5,28S28,23.29,28,17.5S23.29,7,17.5,7z M17.5,25c-4.136,0-7.5-3.364-7.5-7.5    c0-4.136,3.364-7.5,7.5-7.5c4.136,0,7.5,3.364,7.5,7.5C25,21.636,21.636,25,17.5,25z"></path></svg></label><label id="toggle-label-dark" for="darkmode-toggle" tabindex="-1"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="nightIcon" x="0px" y="0px" viewBox="0 0 100 100" style="enable-background:new 0 0 100 100" xml:space="preserve"><title>Dark mode</title><path d="M96.76,66.458c-0.853-0.852-2.15-1.064-3.23-0.534c-6.063,2.991-12.858,4.571-19.655,4.571  C62.022,70.495,50.88,65.88,42.5,57.5C29.043,44.043,25.658,23.536,34.076,6.47c0.532-1.08,0.318-2.379-0.534-3.23  c-0.851-0.852-2.15-1.064-3.23-0.534c-4.918,2.427-9.375,5.619-13.246,9.491c-9.447,9.447-14.65,22.008-14.65,35.369  c0,13.36,5.203,25.921,14.65,35.368s22.008,14.65,35.368,14.65c13.361,0,25.921-5.203,35.369-14.65  c3.872-3.871,7.064-8.328,9.491-13.246C97.826,68.608,97.611,67.309,96.76,66.458z"></path></svg></label></div><div class="explorer desktop-only"><button type="button" id="explorer" data-behavior="collapse" data-collapsed="collapsed" data-savestate="true" data-tree="[{&quot;path&quot;:&quot;API&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;Collections&quot;,&quot;collapsed&quot;:true},{&quot;path&quot;:&quot;Why&quot;,&quot;collapsed&quot;:true}]"><h1>Explorer</h1><svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="explorer-content"><ul class="overflow" id="explorer-ul"><li><div class="folder-outer open"><ul style="padding-left:0;" class="content" data-folderul><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="API"><button class="folder-button"><span class="folder-title">API</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="API"><li><a href="../API/FSharp-Integration" data-for="API/FSharp-Integration">FSharp Integration</a></li><li><a href="../API/Helper" data-for="API/Helper">Helper</a></li><li><a href="../API/Indexing" data-for="API/Indexing">Indexing</a></li><li><a href="../API/Key-Semantics" data-for="API/Key-Semantics">Key Semantics</a></li><li><a href="../API/Operators" data-for="API/Operators">Operators</a></li><li><a href="../API/Optional" data-for="API/Optional">Optional</a></li><li><a href="../API/PowerLINQ" data-for="API/PowerLINQ">PowerLINQ</a></li></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Collections"><button class="folder-button"><span class="folder-title">Collections</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Collections"><li><a href="../Collections/ImmList" data-for="Collections/ImmList">ImmList</a></li><li><a href="../Collections/ImmMap" data-for="Collections/ImmMap">ImmMap</a></li><li><a href="../Collections/ImmSet" data-for="Collections/ImmSet">ImmSet</a></li></ul></div></li><li><div class="folder-outer "><ul style="padding-left:0;" class="content" data-folderul></ul></div></li><li><div class="folder-container"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="5 8 14 8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="folder-icon"><polyline points="6 9 12 15 18 9"></polyline></svg><div data-folderpath="Why"><button class="folder-button"><span class="folder-title">Why</span></button></div></div><div class="folder-outer "><ul style="padding-left:1.4rem;" class="content" data-folderul="Why"><li><a href="../Why/Immutable-collections" data-for="Why/Immutable-collections">Immutable collections</a></li><li><a href="../Why/Not-immutable-collections" data-for="Why/Not-immutable-collections">Not immutable collections</a></li></ul></div></li></ul></div></li><li id="explorer-end"></li></ul></div></div></div><div class="center"><div class="page-header"><div class="popover-hint"><nav class="breadcrumb-container " aria-label="breadcrumbs"><div class="breadcrumb-element"><a href="../">Home</a><p> ❯ </p></div><div class="breadcrumb-element"><a href="../API/">API</a></div></nav><h1 class="article-title ">Optional</h1><p class="content-meta ">Jan 02, 2024, 6 min read</p></div></div><article class="popover-hint"><p>The <a href="T:Optional'1" class="external"><code>Optional&lt;T></code></a> type is a really useful feature that indicates an optional value of type <code>T</code>.</p>
<h2 id="why-do-you-need-it">Why do you need it?<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#why-do-you-need-it" class="internal alias"> §</a></h2>
<p>In particular, why not just use <code>null</code> and nullable types?</p>
<h3 id="uniformityabstraction">Uniformity/Abstraction<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#uniformityabstraction" class="internal alias"> §</a></h3>
<p>The .NET framework does not have a single nullable type that can be used to indicate an optional value. It has two distinct kinds of types, nullable value types and (nullable) reference types.</p>
<p>This means it’s not possible to write a method like this:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="csharp" data-theme="github-dark github-light"><code data-language="csharp" data-theme="github-dark github-light" style="display:grid;"><span data-line><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">///Returns the first element in the list, or None if it's empty.</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">Optional</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">&lt;</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">T</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">></span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> TryFirst { </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">..</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">. }</span></span></code></pre></figure>
<p>Because replacing <code>Optional&lt;T></code> with <code>T?</code> is invalid for reference types, and saying <code>T : class</code> would be absurdly restrictive.</p>
<p>This is why the .NET framework is littered with ugly and inconvenient things like:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="csharp" data-theme="github-dark github-light"><code data-language="csharp" data-theme="github-dark github-light" style="display:grid;"><span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">bool</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> TryGet</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">TKey</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> key</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">, </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">out</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> TValue</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> value</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">);</span></span></code></pre></figure>
<h3 id="less-ambiguity">Less ambiguity<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#less-ambiguity" class="internal alias"> §</a></h3>
<p>The fact a reference type is nullable means it’s <em>implicitly optional</em>. That is, all reference types behave kind of like <a href="T:Optional'1" class="external"><code>Optional&lt;T></code></a> in that they may not exist. However, in most cases, people do not expect a reference type to be null, or else it’s just treated as a kind of invalid value that indicates a bug.</p>
<p>This is one of the reasons nulls are so bad. But optional values make perfect sense in many cases. You just need to be clear about what’s optional and what isn’t. And optional types let you do that.</p>
<h3 id="easier-debugging">Easier Debugging<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#easier-debugging" class="internal alias"> §</a></h3>
<p>Nulls are problematic because they are hard to debug. A <code>NullReferenceException</code> tells you next to nothing about what caused the error, partly because anything could be null, and partly because nulls do not contain any runtime type information.</p>
<p><code>None</code> values, in contrast, are still values and do contain information. So when a <a href="T:NoValueException" class="external"><code>NoValueException</code></a> is thrown, you also get the underlying type and possibly some other information.</p>
<p>You can also see additional info in the debugger, where for a null value you’d just see… <code>null</code>.</p>
<h3 id="you-can-call-instance-members">You can call instance members<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#you-can-call-instance-members" class="internal alias"> §</a></h3>
<p>Since optionals aren’t evil nulls, you can call instance members on them, even when they indicate a missing value. This means you can still use <code>ToString</code>, <code>Equals</code>, and <code>GetHashCode</code>, for example.</p>
<h2 id="how-does-it-work">How does it work?<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#how-does-it-work" class="internal alias"> §</a></h2>
<p>The Imms optional type is a non-nullable value type. It is different from F#‘s <code>Option</code> type.</p>
<p>An <code>Optional&lt;T></code> has two <em>states</em>: <code>Some(T)</code>, in which it wraps a value of type <code>T</code>, and <code>None</code>, in which it wraps no value.</p>
<p>You can check what state it’s in using the following code:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="csharp" data-theme="github-dark github-light"><code data-language="csharp" data-theme="github-dark github-light" style="display:grid;"><span data-line><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">Optional</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&lt;</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">T</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">> </span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">x</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">;</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">if</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(x.IsSome) {</span></span>
<span data-line><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">    //x is Some</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">}</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">if</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> (x.IsNone) {</span></span>
<span data-line><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">    //x is None</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">}</span></span></code></pre></figure>
<p>And you can expose the underlying value (if any) using:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="csharp" data-theme="github-dark github-light"><code data-language="csharp" data-theme="github-dark github-light" style="display:grid;"><span data-line><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">Optional</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&lt;</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">int</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">> </span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">s</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> Optional.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">Some</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">5</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">);</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">int</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> v</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> s.Value;</span></span></code></pre></figure>
<p>Note that calling <code>Value</code> on a <code>None</code> instance throws an exception (a <code>NoValueException</code>, a subtype of <code>InvalidOperationException</code>, is thrown in this case). The exception provides more information than <code>NullReferenceException</code>, such as the underlying type.</p>
<p>Note that the <code>None</code> values of optionals with different types are functionally distinct in some cases, but are still equal under <code>Equals</code> and <code>GetHashCode</code>. They may also be compared using the <code>==</code> operator.</p>
<p>There is an assortment of methods for interacting with optional values, such as <code>.Map</code>, <code>.Cast</code>, <code>.Or</code>, etc.</p>
<h2 id="how-is-it-used-in-imms">How is it used in Imms?<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#how-is-it-used-in-imms" class="internal alias"> §</a></h2>
<p>Optionals are used quite often in Imms, almost every time a value may or may not exist. They’re also often used in optional parameters, though not always (usually for the sake of brevity).</p>
<p>Here are some examples:</p>
<ol>
<li><a href="M:AbstractSequential'2.FindIndex" class="external"><code>FindIndex</code></a>, which may not find the index in question.</li>
<li><a href="M:AbstractMap'3.TryGet" class="external"><code>TryGet</code></a>, which may not find the key in question.</li>
<li><a href="M:AbstractIterable'3.Pick''1(Func%7B'0,Optional%7B''0%7D%7D)" class="external"><code>Pick</code></a>, which takes a function that returns an <code>Optional</code>.</li>
</ol>
<h2 id="how-do-i-make-one">How do I make one?<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#how-do-i-make-one" class="internal alias"> §</a></h2>
<p>You can create an instance of an optional value in several ways.</p>
<h3 id="the-optional-helper-class">The <a href="T:Optional" class="external alias">Optional helper class</a><a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#the-optional-helper-class" class="internal alias"> §</a></h3>
<p>The <code>Optional</code> static class contains a number of static methods for constructing optional values. You can use the <code>use static</code> feature of C# 6 to integrate it better with the language.</p>
<ol>
<li><a href="M:Optional.Some" class="external"><code>Optional.Some(x)</code></a> wraps <code>x</code> in a <code>Some</code> value.</li>
<li><a href="P:Optional.None" class="external"><code>Optional.None</code></a> returns a special token that can be implicitly converted to the <code>None</code> value of any optional type.</li>
<li><a href="M:Optional.NoneOf" class="external"><code>Optional.NoneOf&lt;T></code></a> returns a typed <code>None</code> value.</li>
</ol>
<h3 id="extension-methods">Extension methods<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#extension-methods" class="internal alias"> §</a></h3>
<p>The extension method <a href="M:OptionalExt.AsOptional" class="external"><code>AsOptional</code></a> (several overloads) lets you convert concrete values into optional values. It maps <code>null</code> values to <code>None</code> values.</p>
<h3 id="implicit-conversions">Implicit conversions<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#implicit-conversions" class="internal alias"> §</a></h3>
<p>There is an implicit conversion from <code>T</code> to <code>Optional&lt;T></code>, so the following code works:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="csharp" data-theme="github-dark github-light"><code data-language="csharp" data-theme="github-dark github-light" style="display:grid;"><span data-line><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">Optional</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&lt;</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">int</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">> </span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">x</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> 5</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">;</span></span></code></pre></figure>
<p>There is also an explicit conversion from <code>Optional&lt;T></code> to <code>T</code>, so the following code compiles but may throw an exception:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="csharp" data-theme="github-dark github-light"><code data-language="csharp" data-theme="github-dark github-light" style="display:grid;"><span data-line><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">Optional</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&lt;</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">int</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">> </span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">x</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">;</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">int</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> y</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> (</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">int</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">)x;</span></span></code></pre></figure>
<h2 id="what-can-i-do-with-it">What can I do with it?<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#what-can-i-do-with-it" class="internal alias"> §</a></h2>
<p>See the documentation of the <code>Optional</code> set of classes for more information, but here is a short list of special operations this type supports.</p>
<h3 id="mapping"><a href="M:OptionalExt.Map" class="external alias">Mapping</a><a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#mapping" class="internal alias"> §</a></h3>
<p>Mapping is similar to C# 6’s conditional access operator, <code>?.</code> (one of the several things you’ll be missing out on, unfortunately). It applies a function on the underlying value, if any, or propagates a <code>None</code>:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="csharp" data-theme="github-dark github-light"><code data-language="csharp" data-theme="github-dark github-light" style="display:grid;"><span data-line><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">Optional</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&lt;</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">int</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">> </span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">n</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> 5</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">;</span></span>
<span data-line><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">Optional</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&lt;</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">string</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">> </span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">str</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> n.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">Map</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">x</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =></span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> x.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">ToString</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">());</span></span></code></pre></figure>
<p>It also has an overload that lets the function return <code>Optional</code> too:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="csharp" data-theme="github-dark github-light"><code data-language="csharp" data-theme="github-dark github-light" style="display:grid;"><span data-line><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">Optional</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&lt;</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">int</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">> </span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">n</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> 5</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">;</span></span>
<span data-line><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">Optional</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&lt;</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">string</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">> </span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">str</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> n.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">Map</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">x</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =></span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> x </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">%</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> 2</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> ==</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> 0</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> ?</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> Some</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(x.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">ToString</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">()) </span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">:</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> None);</span></span></code></pre></figure>
<h3 id="coalescing"><a href="M:OptionalExt.Or" class="external alias">Coalescing</a><a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#coalescing" class="internal alias"> §</a></h3>
<p>This works similar to the <code>??</code> operator, another goody:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="csharp" data-theme="github-dark github-light"><code data-language="csharp" data-theme="github-dark github-light" style="display:grid;"><span data-line><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">Optional</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&lt;</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">int</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">> </span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">a</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;"> 5</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">;</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">int</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> b</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> a.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">Or</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">6</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">);</span></span></code></pre></figure>
<p>It also has an overload in which the default value is also optional:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="csharp" data-theme="github-dark github-light"><code data-language="csharp" data-theme="github-dark github-light" style="display:grid;"><span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">var</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> a</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> Some</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">5</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">);</span></span>
<span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">var</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> b</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> Some</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#79B8FF;--shiki-light:#005CC5;">6</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">);</span></span>
<span data-line><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">Optional</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&lt;</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">int</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">> </span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">c</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;"> a.</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">Or</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(b);</span></span></code></pre></figure>
<h3 id="equating"><a href="M:Optional'1.Equals" class="external alias">Equating</a><a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#equating" class="internal alias"> §</a></h3>
<p>You can equate optionals with other optionals, both using the <a href="M:Optional'1.op_Equality" class="external"><code>==</code></a> operator and using the <code>.Equals</code> method. Equality is structural. Two optionals of different declared types may be equal if their underlying values are equal. All <code>None</code> values are equal, whatever the underlying type.</p>
<h3 id="optional-parameters">Optional parameters<a aria-hidden="true" tabindex="-1" data-no-popover="true" href="#optional-parameters" class="internal alias"> §</a></h3>
<p>You can use optionals for optional parameters, but this usage is a bit tricky. This is because those need to have default value which is a compile-time constant, and optionals are structs that can’t take on the null value.</p>
<p>However, this problem can be solved, albeit in a rather verbose way:</p>
<figure data-rehype-pretty-code-figure><pre tabindex="0" data-language="csharp" data-theme="github-dark github-light"><code data-language="csharp" data-theme="github-dark github-light" style="display:grid;"><span data-line><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">void</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;"> ExampleMethod</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">Optional</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&lt;</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">int</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">> </span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">a</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> =</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;"> default</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">(</span><span style="--shiki-dark:#B392F0;--shiki-light:#6F42C1;">Optional</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">&lt;</span><span style="--shiki-dark:#F97583;--shiki-light:#D73A49;">int</span><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">>)) {</span></span>
<span data-line><span style="--shiki-dark:#6A737D;--shiki-light:#6A737D;">    //...</span></span>
<span data-line><span style="--shiki-dark:#E1E4E8;--shiki-light:#24292E;">}</span></span></code></pre></figure>
<p>This technique is mainly useful when you want to accept an optional parameter of type <code>T</code>, which (as mentioned previously), cannot be achieved otherwise.</p></article></div><div class="right sidebar"><div class="graph "><h3>Graph View</h3><div class="graph-outer"><div id="graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:1,&quot;scale&quot;:1.1,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[]}"></div><svg version="1.1" id="global-graph-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 55 55" fill="currentColor" xml:space="preserve"><path d="M49,0c-3.309,0-6,2.691-6,6c0,1.035,0.263,2.009,0.726,2.86l-9.829,9.829C32.542,17.634,30.846,17,29,17
	s-3.542,0.634-4.898,1.688l-7.669-7.669C16.785,10.424,17,9.74,17,9c0-2.206-1.794-4-4-4S9,6.794,9,9s1.794,4,4,4
	c0.74,0,1.424-0.215,2.019-0.567l7.669,7.669C21.634,21.458,21,23.154,21,25s0.634,3.542,1.688,4.897L10.024,42.562
	C8.958,41.595,7.549,41,6,41c-3.309,0-6,2.691-6,6s2.691,6,6,6s6-2.691,6-6c0-1.035-0.263-2.009-0.726-2.86l12.829-12.829
	c1.106,0.86,2.44,1.436,3.898,1.619v10.16c-2.833,0.478-5,2.942-5,5.91c0,3.309,2.691,6,6,6s6-2.691,6-6c0-2.967-2.167-5.431-5-5.91
	v-10.16c1.458-0.183,2.792-0.759,3.898-1.619l7.669,7.669C41.215,39.576,41,40.26,41,41c0,2.206,1.794,4,4,4s4-1.794,4-4
	s-1.794-4-4-4c-0.74,0-1.424,0.215-2.019,0.567l-7.669-7.669C36.366,28.542,37,26.846,37,25s-0.634-3.542-1.688-4.897l9.665-9.665
	C46.042,11.405,47.451,12,49,12c3.309,0,6-2.691,6-6S52.309,0,49,0z M11,9c0-1.103,0.897-2,2-2s2,0.897,2,2s-0.897,2-2,2
	S11,10.103,11,9z M6,51c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S8.206,51,6,51z M33,49c0,2.206-1.794,4-4,4s-4-1.794-4-4
	s1.794-4,4-4S33,46.794,33,49z M29,31c-3.309,0-6-2.691-6-6s2.691-6,6-6s6,2.691,6,6S32.309,31,29,31z M47,41c0,1.103-0.897,2-2,2
	s-2-0.897-2-2s0.897-2,2-2S47,39.897,47,41z M49,10c-2.206,0-4-1.794-4-4s1.794-4,4-4s4,1.794,4,4S51.206,10,49,10z"></path></svg></div><div id="global-graph-outer"><div id="global-graph-container" data-cfg="{&quot;drag&quot;:true,&quot;zoom&quot;:true,&quot;depth&quot;:-1,&quot;scale&quot;:0.9,&quot;repelForce&quot;:0.5,&quot;centerForce&quot;:0.3,&quot;linkDistance&quot;:30,&quot;fontSize&quot;:0.6,&quot;opacityScale&quot;:1,&quot;showTags&quot;:true,&quot;removeTags&quot;:[]}"></div></div></div><div class="toc desktop-only"><button type="button" id="toc" class><h3>Table of Contents</h3><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="fold"><polyline points="6 9 12 15 18 9"></polyline></svg></button><div id="toc-content"><ul class="overflow"><li class="depth-0"><a href="#why-do-you-need-it" data-for="why-do-you-need-it">Why do you need it?</a></li><li class="depth-1"><a href="#uniformityabstraction" data-for="uniformityabstraction">Uniformity/Abstraction</a></li><li class="depth-1"><a href="#less-ambiguity" data-for="less-ambiguity">Less ambiguity</a></li><li class="depth-1"><a href="#easier-debugging" data-for="easier-debugging">Easier Debugging</a></li><li class="depth-1"><a href="#you-can-call-instance-members" data-for="you-can-call-instance-members">You can call instance members</a></li><li class="depth-0"><a href="#how-does-it-work" data-for="how-does-it-work">How does it work?</a></li><li class="depth-0"><a href="#how-is-it-used-in-imms" data-for="how-is-it-used-in-imms">How is it used in Imms?</a></li><li class="depth-0"><a href="#how-do-i-make-one" data-for="how-do-i-make-one">How do I make one?</a></li><li class="depth-1"><a href="#the-optional-helper-class" data-for="the-optional-helper-class">The Optional helper class</a></li><li class="depth-1"><a href="#extension-methods" data-for="extension-methods">Extension methods</a></li><li class="depth-1"><a href="#implicit-conversions" data-for="implicit-conversions">Implicit conversions</a></li><li class="depth-0"><a href="#what-can-i-do-with-it" data-for="what-can-i-do-with-it">What can I do with it?</a></li><li class="depth-1"><a href="#mapping" data-for="mapping">Mapping</a></li><li class="depth-1"><a href="#coalescing" data-for="coalescing">Coalescing</a></li><li class="depth-1"><a href="#equating" data-for="equating">Equating</a></li><li class="depth-1"><a href="#optional-parameters" data-for="optional-parameters">Optional parameters</a></li></ul></div></div><div class="backlinks "><h3>Backlinks</h3><ul class="overflow"><li>No backlinks found</li></ul></div></div></div><footer class><hr/><p>Created with <a href="https://quartz.jzhao.xyz/">Quartz v4.1.4</a>, © 2024</p><ul><li><a href="https://github.com/Gregros/imms">GitHub</a></li></ul></footer></div></body><script src="https://cdn.jsdelivr.net/npm/katex@0.16.7/dist/contrib/copy-tex.min.js" type="application/javascript"></script><script type="application/javascript">// quartz/components/scripts/quartz/components/scripts/callout.inline.ts
function toggleCallout() {
  const outerBlock = this.parentElement;
  outerBlock.classList.toggle(`is-collapsed`);
  const collapsed = outerBlock.classList.contains(`is-collapsed`);
  const height = collapsed ? this.scrollHeight : outerBlock.scrollHeight;
  outerBlock.style.maxHeight = height + `px`;
  let current = outerBlock;
  let parent = outerBlock.parentElement;
  while (parent) {
    if (!parent.classList.contains(`callout`)) {
      return;
    }
    const collapsed2 = parent.classList.contains(`is-collapsed`);
    const height2 = collapsed2 ? parent.scrollHeight : parent.scrollHeight + current.scrollHeight;
    parent.style.maxHeight = height2 + `px`;
    current = parent;
    parent = parent.parentElement;
  }
}
function setupCallout() {
  const collapsible = document.getElementsByClassName(
    `callout is-collapsible`
  );
  for (const div of collapsible) {
    const title = div.firstElementChild;
    if (title) {
      title.removeEventListener(`click`, toggleCallout);
      title.addEventListener(`click`, toggleCallout);
      const collapsed = div.classList.contains(`is-collapsed`);
      const height = collapsed ? title.scrollHeight : div.scrollHeight;
      div.style.maxHeight = height + `px`;
    }
  }
}
document.addEventListener(`nav`, setupCallout);
window.addEventListener(`resize`, setupCallout);
</script><script type="module">import "/api-links.js";
          </script><script type="module">
          import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.esm.min.mjs';
          const darkMode = document.documentElement.getAttribute('saved-theme') === 'dark'
          mermaid.initialize({
            startOnLoad: false,
            securityLevel: 'loose',
            theme: darkMode ? 'dark' : 'default'
          });
          document.addEventListener('nav', async () => {
            await mermaid.run({
              querySelector: '.mermaid'
            })
          });
          </script><script type="application/javascript">
          const socket = new WebSocket('ws://localhost:3001')
          socket.addEventListener('message', () => document.location.reload())
        </script><script src="../postscript.js" type="module"></script></html>